pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	draw_map()
end


function _update()
	update_camera()
	
	move()
	
	if btnp(❎) then
		shoot()
	end

	for arrow in all(arrows) do
		arrow.x += arrow.dir
	end
end

function _draw()
	cls()
	map()
	draw_player()

	for arrow in all(arrows) do
		spr(arrow.sp, arrow.x, arrow.y, 1, 1, arrow.flip)
	end
end


-->8
p = {sprite=1,x=7,y=3,largeur=8,hauteur=8,life=100,flip=false}
arrows = {}

function draw_player() 
 spr(p.sprite,p.x*8,p.y*8,1,1,p.flip)
end

function shoot()
 add(arrows, {
 	x = p.x * 8,
 	y = p.y * 8,
  sp = 2,  
  dir = p.flip and -2 or 2, 
  flip = p.flip 
 })
 sfx(0)
end


function move()
  local speed = 1 
  local newx = p.x
  local newy = p.y

  if btnp(⬅️) then 
   newx -= speed
   p.flip = true
  end
  if btnp(➡️) then 
   newx += speed
   p.flip = false
  end
  if btnp(⬆️) then 
   newy -= speed 
  end
  if btnp(⬇️) then 
   newy += speed 
  end

  if not check_flag(0, newx, newy) then
   p.x = mid(0,newx,127) 
   p.y = mid(0,newy,63)    
  end
end



-->8
-- map 

function draw_map()
	map(0,0,0,0,128,64)
end

function check_flag(flag, x, y) 
 local sprite = mget(x, y)
 return fget(sprite, flag)
end

function update_camera()
	-- flr arrondi en bas
	camx=flr(p.x/16)*16
	camy=flr(p.y/16)*16
	camera(camx*8,camy*8)
end

function follow_camera()
	camx=mid(0,p.x-7.5,127-119)
	camy=flr(0,p.y-7.5,127-119)
	camera(camx*8,camy*8)
end
__gfx__
0000000005550900000000000000000000000000000000000000000000000000000000003333333333bbbb334444444400044444000000000000000000000000
000000005555509000000000000000000000000000000000000000000000000000000000333333333bbaabb34444444404044444000000000000000000000000
007007005765609000000000000000000000000000000000000000000000000000000000333333333bbbab13cccccccc00040004000000000000000000000000
000770000777707074460000000000000000000000000000000000000000000000000000333333333bbbb3131111111140444444000000000000000000000000
00077000555555900000000000000000000000000000000000000000000000000000000033333333313b33131111111140444444000000000000000000000000
00700700755550900000000000000000000000000000000000000000000000000000000033333333331111331111111100040004000000000000000000000000
00000000055559000000000000000000000000000000000000000000000000000000000033333333333223331111111104044444000000000000000000000000
00000000060060000000000000000000000000000000000000000000000000000000000033333333331442331111111100044444000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333333000000001111111144444000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333373000000001111111144444040000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333797000000001111111140004000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033373373000000001111111144444404000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033797333000000001111111144444404000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033373333000000001111111140004000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333333000000001111111144444040000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333333000000001111111144444000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333333333333330000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000003333373333bb333b0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033337873333b33bb0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000333337333b3bb3b30000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000373333333bb3bbb30000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000007873333333b3bb330000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000003733333333b3bb330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000033333333333333330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055555555000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000056555556000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055555555000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055556555000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055555555000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055565556000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000056555555000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000055555555000000000000000000000000000000000000000000000000
0033b3b33b3333b3bb33b3000000000044444444000000000000b333333300000000000000000000000000000000000000000000000000000000000000000000
33333333333333333333333300000000444444440000000000bb3333333333000000000000000000000000000000000000000000000000000000000000000000
33443334334433343344333400000000444444440000044400333333333333300000000000000000000000000000000000000000000000000000000000000000
44444344444443444444434400033000444444440004440003333bbb33333bb30000000000000000000000000000000000000000000000000000000000000000
444444444444444444444444300300304444444444444000033bbb33bbb333bb0000000000000000000000000000000000000000000000000000000000000000
064444666644446666444460030303304444444444440000333b333333bb333b0000000000000000000000000000000000000000000000000000000000000000
0556566565565665655656600333030044444444400000003b333333333333330000000000000000000000000000000000000000000000000000000000000000
0055555555555555555555000333333044444444000000003b333333333333330000000000000000000000000000000000000000000000000000000000000000
00000000ab3338b300000000000000000000000000000000333bb333333b33bb0000000000000000000000000000000000000000000000000000000000000000
0000000033a3833800000000000000000000000000000000bbbb333333bb33b30000000000000000000000000000000000000000000000000000000000000000
000000003a44383400000000000000000000000044400000333333b33bb333330000000000000000000000000000000000000000000000000000000000000000
00000000444443440000000000000000000000000044400033bb33b3333333330000000000000000000000000000000000000000000000000000000000000000
000000004444444400000000000070000000000400044444033b33b33333bb300000000000000000000000000000000000000000000000000000000000000000
0000000066444466000000000007a700000000440000044403bb33bbbbbbb3300000000000000000000000000000000000000000000000000000000000000000
00000000655656650000000003037000000004440000000400b3333bbb3333000000000000000000000000000000000000000000000000000000000000000000
00000000555555550000000000330000000444440000000000003333333300000000000000000000000000000000000000000000000000000000000000000000
00000000cccccccc00000000000000000000000004444000333bb333000000000000000000000000000000000000000000000000000000000000000000000000
0000000033cccc33000000000000000000000000004440003bbb3333000000000000000000000000000000000000000000000000000000000000000000000000
00000000334433340000000000000000000000000004440033333333000000000000000000000000000000000000000000000000000000000000000000000000
000000004444434400000000000700000000000000044440333333b3000000000000000000000000000000000000000000000000000000000000000000000000
000000004444444400000000007870004000000000004444333333b3000000000000000000000000000000000000000000000000000000000000000000000000
000000006644446600000000000733004400000000000444333333bb000000030000000000000000000000000000000000000000000000000000000000000000
00000000655656650000000000000300444000000000004433333333000000330000000000000000000000000000000000000000000000000000000000000000
00000000555555550000000000003300444440000000000433333333000003bb0000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000b333333300000444333bb333000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000003344433300004440bb8b3333000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000444444440004440033333383000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000444444440444400033bb33b3000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000004444444444440000333b83b3300000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000444444444440000038bb33bb330000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000444444444400000033b3333bbbb000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000004444444440000000bbb33333333330000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000001010000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1b1b1b1b0a0a0a090a0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b1b1b2a2a2a2a09090909090a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b1b092a2a09090909092929290a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b0909090909090909090a292929090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09090909090a0909090a0a0a2929290900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a09090a0a0a090909090a0a0a09090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a090a0a090909090909090a0a09090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0909090909090929090a09090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a090909190909090909090909090b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a091919090a09090a0b0b0b0b0b1b1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006746664700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0909090b0c1c0b1b1b1b1b1b1b1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000467666667600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b1b0c1c1b1b1b090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000766666765700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b1b1b1b1b1b0909090909090909092a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000565774750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a09092a2a2a09091929290909092a2a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005544000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a09092a2a2a2a090929190909092a2a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000544464534300530b004300634300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0909092a2a2a090909090909092a2a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000405141414151614141415151414161420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000026710257102471023710207101d71018710127000f7001400012000100000e0000d0000c000150001900007000080000b0000e000100001100015000180001b0001e0002200026000290002c0002f000
